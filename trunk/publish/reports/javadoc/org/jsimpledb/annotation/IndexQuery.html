<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_45) on Mon Aug 18 11:36:30 CDT 2014 -->
<title>IndexQuery (Java Class Library API)</title>
<meta name="date" content="2014-08-18">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="IndexQuery (Java Class Library API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/IndexQuery.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../org/jsimpledb/annotation/JField.html" title="annotation in org.jsimpledb.annotation"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/jsimpledb/annotation/IndexQuery.html" target="_top">Frames</a></li>
<li><a href="IndexQuery.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#annotation_type_required_element_summary">Required</a>&nbsp;|&nbsp;</li>
<li><a href="#annotation_type_optional_element_summary">Optional</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#annotation_type_element_detail">Element</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.jsimpledb.annotation</div>
<h2 title="Annotation Type IndexQuery" class="title">Annotation Type IndexQuery</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre><a href="http://download.oracle.com/javase/7/docs/api/java/lang/annotation/Retention.html?is-external=true" title="class or interface in java.lang.annotation">@Retention</a>(<a href="http://download.oracle.com/javase/7/docs/api/java/lang/annotation/Retention.html?is-external=true#value()" title="class or interface in java.lang.annotation">value</a>=<a href="http://download.oracle.com/javase/7/docs/api/java/lang/annotation/RetentionPolicy.html?is-external=true#RUNTIME" title="class or interface in java.lang.annotation">RUNTIME</a>)
<a href="http://download.oracle.com/javase/7/docs/api/java/lang/annotation/Target.html?is-external=true" title="class or interface in java.lang.annotation">@Target</a>(<a href="http://download.oracle.com/javase/7/docs/api/java/lang/annotation/Target.html?is-external=true#value()" title="class or interface in java.lang.annotation">value</a>=<a href="http://download.oracle.com/javase/7/docs/api/java/lang/annotation/ElementType.html?is-external=true#METHOD" title="class or interface in java.lang.annotation">METHOD</a>)
<a href="http://download.oracle.com/javase/7/docs/api/java/lang/annotation/Documented.html?is-external=true" title="class or interface in java.lang.annotation">@Documented</a>
public @interface <a href="../../../src-html/org/jsimpledb/annotation/IndexQuery.html#line.108">IndexQuery</a></pre>
<div class="block">Annotates JSimpleDB model class methods that access the index associated with an indexed field.

 <p>
 The annotated method must be abstract, take zero parameters, and return
 <a href="http://download.oracle.com/javase/7/docs/api/java/util/NavigableMap.html?is-external=true" title="class or interface in java.util"><code>NavigableMap</code></a><code>&lt;V, </code><a href="http://download.oracle.com/javase/7/docs/api/java/util/NavigableSet.html?is-external=true" title="class or interface in java.util"><code>NavigableSet</code></a><code>&lt;T&gt;&gt;</code>, where
 <code>V</code> is the type of the indexed field's values, and <code>T</code> is the type of the Java model object
 containing the field.
 </p>

 <p>
 For example:
 <pre>
 &#64;JSimpleClass(storageId = 10)
 public abstract class <b>Person</b> {

     &#64;JSetField(storageId = 11, element = @JField(storageId = 12, <b>indexed = true</b>))
     public abstract Set&lt;<b>String</b>&gt; getNicknames();

     <b>&#64;IndexQuery("nicknames")</b>
     private abstract NavigableMap&lt;<b>String</b>, NavigableSet&lt;<b>Person</b>&gt;&gt; queryNicknames();

     // Get all people with the given nickname
     public Set&lt;Person&gt; getPeopleWithNickame(String nickname) {
         final Set&lt;Person&gt; people = this.queryNicknames().get(nickname);
         return people != null ? people : Collections.&lt;Person&gt;emptySet();
     }

     // Get all known nicknames, sorted by nickname
     public NavigableSet&lt;String&gt; getAllNickames() {
         return this.queryNicknames().navigableKeySet();
     }

     // Do an "inner join" on two nicknames
     public NavigableSet&lt;Person&gt; getPeopleWithBothNicknames(String nickname1, String nickname2) {
         return NaviableSets.intersection(this.getPeopleWithNickame(nickname1), this.getPeopleWithNickame(nickname2));
     }
 }
 </pre>
 </p>

 <p>
 The returned <a href="http://download.oracle.com/javase/7/docs/api/java/util/NavigableMap.html?is-external=true" title="class or interface in java.util"><code>NavigableMap</code></a> contains an entry for every value that is actually present
 in the field in some object, with the corresponding value being the set of those objects. It represents a "live" view:
 if an indexed field is modified, any previously returned <a href="http://download.oracle.com/javase/7/docs/api/java/util/NavigableMap.html?is-external=true" title="class or interface in java.util"><code>NavigableMap</code></a> updates itself
 immediately (whether "live" iterators update depends on the behavior of the underlying key/value database; see
 <a href="../../../org/jsimpledb/kv/KVStore.html#getRange(byte[], byte[], boolean)"><code>KVStore.getRange()</code></a>).
 </p>

 <p>
 For list and map fields, you may also query the index for additional information beyond just which objects contain
 the queried value in the indexed field: in the case of a list, you can also get the
 list index, and in the case of a map, you can also get the corresponding key or value. For these kinds of query, specify the
 type <code>T</code> to be either <a href="../../../org/jsimpledb/ListIndexEntry.html" title="class in org.jsimpledb"><code>ListIndexEntry</code></a>,
 <a href="../../../org/jsimpledb/MapKeyIndexEntry.html" title="class in org.jsimpledb"><code>MapKeyIndexEntry</code></a>, or <a href="../../../org/jsimpledb/MapValueIndexEntry.html" title="class in org.jsimpledb"><code>MapValueIndexEntry</code></a> as appropriate. For example:
 <pre>
 public class <b>Company</b> {

     &#64;JMapField(storageId = 11,
       key = &#64;JSimpleField(storageId = 12, <b>indexed = true</b>),
       value = &#64;JSimpleField(storageId = 13, type = "float")) // primitive type to disallow nulls
     public abstract Map&lt;<b>Vendor</b>, <b>Float</b>&gt; getAccountsPayable();

     // Query to get mapping by Vendor of which Company's owe that vendor and how much they owe
     <b>&#64;IndexQuery("accountsPayable.key")</b>
     private abstract NavigableMap&lt;<b>Vendor</b>, NavigableSet&lt;<b>MapKeyIndexEntry&lt;Company, Float&gt;</b>&gt;&gt; queryVendorDebts();
 }
 </pre>
 </p>

 <p>
 The annotation <a href="../../../org/jsimpledb/annotation/IndexQuery.html#value()"><code>value()</code></a> contains the name of the indexed field to query (also known as a relative
 <a href="../../../org/jsimpledb/ReferencePath.html" title="class in org.jsimpledb"><code>ReferencePath</code></a> with zero intermediate references).
 The field is assumed to be contained in the class containing the annotated method; however, a different
 "starting type" may be specified via <a href="../../../org/jsimpledb/annotation/IndexQuery.html#startType()"><code>startType()</code></a>.
 </p>

 <p>
 The annotated method must be an instance method. Static methods would be more appropriate (the index query is
 not specific to any instance), but static methods cannot be overridden by generated subclasses. To query an index
 from a static context, see <a href="../../../org/jsimpledb/JTransaction.html#queryIndex(java.lang.Class, java.lang.String, java.lang.Class)"><code>JTransaction.queryIndex()</code></a> which provides
 the same functionality as this annotation via direct method invocation.
 </p></div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../org/jsimpledb/JTransaction.html#queryIndex(java.lang.Class, java.lang.String, java.lang.Class)"><code>JTransaction.queryIndex()</code></a>, 
<a href="../../../org/jsimpledb/JTransaction.html#queryListFieldEntries(java.lang.Class, java.lang.String, java.lang.Class)"><code>JTransaction.queryListFieldEntries()</code></a>, 
<a href="../../../org/jsimpledb/JTransaction.html#queryMapFieldKeyEntries(java.lang.Class, java.lang.String, java.lang.Class, java.lang.Class)"><code>JTransaction.queryMapFieldKeyEntries()</code></a>, 
<a href="../../../org/jsimpledb/JTransaction.html#queryMapFieldKeyEntries(java.lang.Class, java.lang.String, java.lang.Class, java.lang.Class)"><code>JTransaction.queryMapFieldKeyEntries()</code></a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== ANNOTATION TYPE REQUIRED MEMBER SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="annotation_type_required_element_summary">
<!--   -->
</a>
<h3>Required Element Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Required Element Summary table, listing required elements, and an explanation">
<caption><span>Required Elements</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Required Element and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="http://download.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../org/jsimpledb/annotation/IndexQuery.html#value()">value</a></strong></code>
<div class="block">Specifies the indexed field to query.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- =========== ANNOTATION TYPE OPTIONAL MEMBER SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="annotation_type_optional_element_summary">
<!--   -->
</a>
<h3>Optional Element Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Optional Element Summary table, listing optional elements, and an explanation">
<caption><span>Optional Elements</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Optional Element and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="http://download.oracle.com/javase/7/docs/api/java/lang/Class.html?is-external=true" title="class or interface in java.lang">Class</a>&lt;?&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../org/jsimpledb/annotation/IndexQuery.html#startType()">startType</a></strong></code>
<div class="block">Specifies the starting type for the <a href="../../../org/jsimpledb/ReferencePath.html" title="class in org.jsimpledb"><code>ReferencePath</code></a> specified by <code>#value</code>.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ ANNOTATION TYPE MEMBER DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="annotation_type_element_detail">
<!--   -->
</a>
<h3>Element Detail</h3>
<a name="value()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>value</h4>
<pre>public abstract&nbsp;<a href="http://download.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;<a href="../../../src-html/org/jsimpledb/annotation/IndexQuery.html#line.126">value</a></pre>
<div class="block">Specifies the indexed field to query.

 <p>
 For complex fields, the sub-field name must be included. For example, <code>"mylist.element"</code> and
 <code>"mymap.value"</code> would be valid, but <code>"mymap"</code> would be invalid.
 <p>

 <p>
 In other words, the value must be a <a href="../../../org/jsimpledb/ReferencePath.html" title="class in org.jsimpledb">reference path</a> with
 zero references not ending on a complex field; see <a href="../../../org/jsimpledb/ReferencePath.html" title="class in org.jsimpledb"><code>ReferencePath</code></a> for information
 on the overall syntax for reference paths.
 </p></div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../org/jsimpledb/ReferencePath.html" title="class in org.jsimpledb"><code>ReferencePath</code></a></dd></dl>
</li>
</ul>
<a name="startType()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>startType</h4>
<pre>public abstract&nbsp;<a href="http://download.oracle.com/javase/7/docs/api/java/lang/Class.html?is-external=true" title="class or interface in java.lang">Class</a>&lt;?&gt;&nbsp;<a href="../../../src-html/org/jsimpledb/annotation/IndexQuery.html#line.139">startType</a></pre>
<div class="block">Specifies the starting type for the <a href="../../../org/jsimpledb/ReferencePath.html" title="class in org.jsimpledb"><code>ReferencePath</code></a> specified by <code>#value</code>.
 This may also be any super-type (e.g., an interface type), as long as the specified field is not ambiguous
 among all sub-types.

 <p>
 If this property is left unset, then then class containing the annotated method is assumed.
 </p></div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../org/jsimpledb/ReferencePath.html" title="class in org.jsimpledb"><code>ReferencePath</code></a></dd></dl>
<dl>
<dt>Default:</dt>
<dd>void.class</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/IndexQuery.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../org/jsimpledb/annotation/JField.html" title="annotation in org.jsimpledb.annotation"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/jsimpledb/annotation/IndexQuery.html" target="_top">Frames</a></li>
<li><a href="IndexQuery.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#annotation_type_required_element_summary">Required</a>&nbsp;|&nbsp;</li>
<li><a href="#annotation_type_optional_element_summary">Optional</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#annotation_type_element_detail">Element</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
